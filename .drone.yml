build:
  image: sivel/python:$${PY/insanity/2.7}
  commands:
    - apt-get update
    - apt-get install apt-transport-https ca-certificates
    - apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
    - echo 'deb https://apt.dockerproject.org/repo debian-jessie main' > /etc/apt/sources.list.d/docker.list
    - apt-get update
    - apt-get install docker-engine
    - git submodule update --init --recursive
    - ./test/utils/run_tests.sh


compose:
  dind:
    image: docker:dind
    privileged: true


matrix:
  TARGET:
    - sanity PY=2.4 TOXENV=py24
    - sanity PY=2.6 TOXENV=py26
    - sanity PY=2.7 TOXENV=py27
    - sanity PY=3.4 TOXENV=py34
    - sanity PY=3.5 TOXENV=py35
    - centos6
    - centos7
    - fedora23
    - fedora-rawhide
    - ubuntu1204
    - ubuntu1404

