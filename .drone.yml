clone:
  recursive: true
  submodule_update_remote: true


script:
  build:
    image: sivel/allsnakes
    volumes:
      - "/sys/fs/cgroup:/sys/fs/cgroup:ro"
      - "/var/run/docker.sock:/var/run/docker.sock"
#    environment:
#      - DOCKER_HOST=unix:///var/run/docker.sock
    commands:
      - netstat -pntl
      - ls -al /sys/fs/cgroup
      - ./test/utils/run_tests.sh


#services:
#  dind:
#    image: docker:dind
#    privileged: true


matrix:
  include:
    - TARGET: sanity
      TOXENV: py24
    - TARGET: sanity
      TOXENV: py26
    - TARGET: sanity
      TOXENV: py27
    - TARGET: sanity
      TOXENV: py34
    - TARGET: sanity
      TOXENV: py35
    - TARGET: centos6
    - TARGET: centos7
      TARGET_OPTIONS: "--volume=/sys/fs/cgroup:/sys/fs/cgroup:ro"
    - TARGET: fedora23
      TARGET_OPTIONS: "--volume=/sys/fs/cgroup:/sys/fs/cgroup:ro"
    - TARGET: fedora-rawhide
      TARGET_OPTIONS: "--volume=/sys/fs/cgroup:/sys/fs/cgroup:ro"
    - TARGET: ubuntu1204
    - TARGET: ubuntu1404
